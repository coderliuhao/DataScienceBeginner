### Mysql 学习笔记 全文本搜索

1、全文本搜索在创建表时通过定义fulltext()子句,将括号中传入的列作为索引，给出被索引列的一个逗号分隔的列表。

2、通过在where 子句中使用 match 和 against 操作符来进行全文本搜索，其中match( )中传入作为索引的列，against( )中传入要搜索的表达式。举例，存在一带全文本搜索支持的表tab,以col列为索引：

​                                   select  col

​                                   from tab

​                                   where match(col) against ("expression" );

tips:   搜索的表达式不区分大小写

​          如果 match中包含多列，则必须与创建表时fulltext()传入的列和列的顺序完全一致

​          match(col) against ("expression" )出现在select中可以作为计算字段返回匹配等级值          



3、全文本搜索的结果是按照文本匹配的好坏排序的，越好的越先被返回，好的定义：

​            1、匹配到行的比没匹配到的行等级高。越好

​            2、在都有匹配的情况下，匹配的词出现越靠前的行，等级越高，越好

​            3、在有多个搜索项的情况下，匹配的词越多的行等级越高，越好

​     相对应的，如果使用like子句配合通配符的方式进行匹配，返回结果则不遵循任何的顺序，这是与全文本搜索的明显区别。

4、查询扩展，除了匹配搜索的词，还将返回可能相关的结果。通过在where的against( )中的搜索词后 使用with query expansion操作符实现。沿用前面例子：

​                                select  col

​                                from  tab

​                                where match(col) against ("expression" with query expansion);

​     查询扩展增加返回的行数，也增加了实际并不需要的行的数目。

 5、布尔文本搜索：即全文本搜索的布尔模式。通过在against()的表达式后增加 in boolean mode 实现。可实现的操作有：

​       (1)返回匹配的词  (2)需要排斥的词 (3)排列提示 (4) 表达式分组 (5)其他

 tips:   布尔方式在非全文本索引(即fulltext ( )没有定义列作为索引)时也能使用。

6、布尔操作符：

​                           +                包含，词必须存在 

​                           -                 排除，词必须不出现

​                           \>                包含且增加等级

​                           \<                包含且降低等级

​                        （）              把词组成表达式

​                           ~                 取消一个词的排序值

​                           \*                 词尾通配符

​                           ""                定义一个短语，对短语进行操作

​    tips:布尔方式返回的结果不按等级降序排序

7、全文本搜索：

​     （1） 索引全文本数据时，短词(3个或3个以下的词)被忽略且从索引中排除

​     （2）mysql中的内建非用词列表，这些词在索引全文本时总被忽略，必要时可以覆盖

​     （3）许多词出现频率很高，意味着返回太多结果，所以搜索它们意义不大。如果一个词出现频率超过50%以上的行中，将它作为非用词忽略，50%规则不用于in boolean mode

​     （4） 表中行数小于3行，全文本搜索不返回结果(50%原则)

​     （5） 忽略词中的d单引号。don't索引为dont

​     （6） 不具有词分隔符的语言不能恰当返回全文本搜索结果  

​     （7） 仅在MyISAM数据库引擎中支持全文本搜素

